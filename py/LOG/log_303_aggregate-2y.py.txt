
#==============================================================================
# START!!! 303_aggregate-2y.py    PID: 4575    time: 2018-07-12 16:16:56.328356
#==============================================================================

  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:11,  1.62it/s] 10%|█         | 2/20 [00:01<00:11,  1.58it/s] 15%|█▌        | 3/20 [00:01<00:09,  1.73it/s] 20%|██        | 4/20 [00:02<00:08,  1.87it/s] 25%|██▌       | 5/20 [00:02<00:08,  1.73it/s] 30%|███       | 6/20 [00:03<00:08,  1.75it/s] 35%|███▌      | 7/20 [00:04<00:07,  1.74it/s] 40%|████      | 8/20 [00:04<00:06,  1.74it/s] 45%|████▌     | 9/20 [00:04<00:06,  1.83it/s] 50%|█████     | 10/20 [00:05<00:05,  1.83it/s] 55%|█████▌    | 11/20 [00:06<00:04,  1.83it/s] 60%|██████    | 12/20 [00:06<00:04,  1.76it/s] 65%|██████▌   | 13/20 [00:07<00:03,  1.76it/s] 70%|███████   | 14/20 [00:07<00:03,  1.82it/s] 75%|███████▌  | 15/20 [00:08<00:02,  1.82it/s] 80%|████████  | 16/20 [00:08<00:02,  1.82it/s] 85%|████████▌ | 17/20 [00:09<00:01,  1.81it/s] 90%|█████████ | 18/20 [00:10<00:01,  1.80it/s] 95%|█████████▌| 19/20 [00:10<00:00,  1.83it/s]100%|██████████| 20/20 [00:10<00:00,  1.85it/s]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.54it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.17it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.93it/s] 30%|███       | 6/20 [00:00<00:01,  8.99it/s] 40%|████      | 8/20 [00:00<00:01,  9.10it/s] 50%|█████     | 10/20 [00:01<00:01,  8.99it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.89it/s] 60%|██████    | 12/20 [00:01<00:00,  8.83it/s] 70%|███████   | 14/20 [00:01<00:00,  8.84it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.90it/s] 80%|████████  | 16/20 [00:01<00:00,  8.94it/s] 85%|████████▌ | 17/20 [00:01<00:00,  8.93it/s] 90%|█████████ | 18/20 [00:02<00:00,  8.81it/s]100%|██████████| 20/20 [00:02<00:00,  9.43it/s]
  0%|          | 0/20 [00:00<?, ?it/s]  0%|          | 0/20 [00:00<?, ?it/s]  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:01<00:31,  1.67s/it] 10%|█         | 2/20 [00:03<00:29,  1.65s/it] 15%|█▌        | 3/20 [00:05<00:28,  1.69s/it] 20%|██        | 4/20 [00:06<00:26,  1.64s/it] 25%|██▌       | 5/20 [00:08<00:25,  1.68s/it] 30%|███       | 6/20 [00:09<00:23,  1.65s/it] 35%|███▌      | 7/20 [00:11<00:21,  1.62s/it] 40%|████      | 8/20 [00:12<00:18,  1.58s/it] 45%|████▌     | 9/20 [00:14<00:17,  1.56s/it] 50%|█████     | 10/20 [00:15<00:15,  1.56s/it]  5%|▌         | 1/20 [00:16<05:10, 16.33s/it] 55%|█████▌    | 11/20 [00:17<00:13,  1.55s/it]  5%|▌         | 1/20 [00:17<05:34, 17.58s/it] 60%|██████    | 12/20 [00:18<00:12,  1.54s/it] 65%|██████▌   | 13/20 [00:19<00:10,  1.53s/it] 70%|███████   | 14/20 [00:21<00:09,  1.52s/it] 75%|███████▌  | 15/20 [00:22<00:07,  1.52s/it] 80%|████████  | 16/20 [00:24<00:06,  1.51s/it] 85%|████████▌ | 17/20 [00:25<00:04,  1.51s/it] 90%|█████████ | 18/20 [00:27<00:03,  1.50s/it] 95%|█████████▌| 19/20 [00:28<00:01,  1.51s/it]100%|██████████| 20/20 [00:29<00:00,  1.50s/it]
 10%|█         | 2/20 [00:35<05:16, 17.59s/it] 10%|█         | 2/20 [00:35<05:22, 17.91s/it]remove var<=0: Index(['delay_DBD_max', 'delay_DBD_mean', 'delay_DBD_sum', 'delay_DBD_nunique',
       'delay_delayed_day_over0_min', 'delay_delayed_day_over0_mean',
       'delay_delayed_day_over0_max', 'delay_delayed_day_over0_var',
       'delay_not-delayed_day_0_min', 'delay_not-delayed_day_0_mean',
       'delay_not-delayed_day_0_max', 'delay_not-delayed_day_0_var',
       'delay_not-delayed_day_0_sum', 'delay_not-delayed_money_0_min',
       'delay_not-delayed_money_0_mean', 'delay_not-delayed_money_0_max',
       'delay_not-delayed_money_0_var', 'delay_not-delayed_money_0_sum',
       'delay_not-delayed_money_ratio_0_min',
       'delay_not-delayed_money_ratio_0_mean',
       'delay_not-delayed_money_ratio_0_max',
       'delay_not-delayed_money_ratio_0_var',
       'delay_not-delayed_money_ratio_0_sum'],
      dtype='object')
 15%|█▌        | 3/20 [00:46<04:22, 15.47s/it] 15%|█▌        | 3/20 [00:50<04:44, 16.71s/it] 20%|██        | 4/20 [00:58<03:54, 14.64s/it] 20%|██        | 4/20 [01:02<04:10, 15.68s/it] 25%|██▌       | 5/20 [01:10<03:30, 14.06s/it] 25%|██▌       | 5/20 [01:18<03:55, 15.70s/it] 30%|███       | 6/20 [01:21<03:09, 13.54s/it] 30%|███       | 6/20 [01:29<03:28, 14.89s/it] 35%|███▌      | 7/20 [01:32<02:51, 13.19s/it] 40%|████      | 8/20 [01:41<02:31, 12.64s/it] 35%|███▌      | 7/20 [01:41<03:07, 14.46s/it] 45%|████▌     | 9/20 [01:51<02:15, 12.34s/it] 40%|████      | 8/20 [01:51<02:47, 13.94s/it] 50%|█████     | 10/20 [02:02<02:02, 12.21s/it] 45%|████▌     | 9/20 [02:02<02:29, 13.57s/it] 55%|█████▌    | 11/20 [02:15<01:50, 12.32s/it] 50%|█████     | 10/20 [02:15<02:15, 13.56s/it] 60%|██████    | 12/20 [02:25<01:37, 12.17s/it] 55%|█████▌    | 11/20 [02:26<01:59, 13.29s/it] 65%|██████▌   | 13/20 [02:37<01:24, 12.12s/it] 60%|██████    | 12/20 [02:37<01:45, 13.15s/it] 70%|███████   | 14/20 [02:49<01:12, 12.09s/it] 65%|██████▌   | 13/20 [02:49<01:31, 13.02s/it] 75%|███████▌  | 15/20 [02:59<00:59, 11.99s/it] 70%|███████   | 14/20 [02:59<01:17, 12.85s/it] 80%|████████  | 16/20 [03:11<00:47, 11.96s/it] 75%|███████▌  | 15/20 [03:11<01:03, 12.77s/it] 85%|████████▌ | 17/20 [03:21<00:35, 11.83s/it] 80%|████████  | 16/20 [03:21<00:50, 12.61s/it] 90%|█████████ | 18/20 [03:57<00:26, 13.22s/it] 85%|████████▌ | 17/20 [04:01<00:42, 14.23s/it] 95%|█████████▌| 19/20 [04:20<00:13, 13.69s/it] 90%|█████████ | 18/20 [04:20<00:28, 14.46s/it]100%|██████████| 20/20 [04:35<00:00, 13.76s/it]
 95%|█████████▌| 19/20 [04:35<00:14, 14.50s/it]100%|██████████| 20/20 [04:47<00:00, 14.38s/it]
remove var<=0: Index(['delayed_day_over25_min', 'delayed_money_25_min',
       'delayed_money_ratio_25_min', 'delayed_day_over30_min',
       'delayed_money_30_min', 'delayed_money_ratio_30_min',
       'delayed_day_over35_min', 'delayed_money_35_min',
       'delayed_money_ratio_35_min', 'delayed_day_over40_min',
       'delayed_money_40_min', 'delayed_money_ratio_40_min',
       'delayed_day_over45_min', 'delayed_money_45_min',
       'delayed_money_ratio_45_min'],
      dtype='object')
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/Kazuki/anaconda3/lib/python3.6/multiprocessing/pool.py", line 119, in worker
    result = (True, func(*args, **kwds))
  File "/home/Kazuki/anaconda3/lib/python3.6/multiprocessing/pool.py", line 44, in mapstar
    return list(map(*args))
  File "303_aggregate-2y.py", line 44, in aggregate
    df = df[df['DAYS_INSTALMENT'].between(day_start, day_end)]
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py", line 2133, in __getitem__
    return self._getitem_array(key)
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py", line 2175, in _getitem_array
    return self._take(indexer, axis=0, convert=False)
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py", line 2143, in _take
    self._consolidate_inplace()
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py", line 3677, in _consolidate_inplace
    self._protect_consolidate(f)
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py", line 3666, in _protect_consolidate
    result = f()
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py", line 3675, in f
    self._data = self._data.consolidate()
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 3826, in consolidate
    bm._consolidate_inplace()
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 3831, in _consolidate_inplace
    self.blocks = tuple(_consolidate(self.blocks))
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 4853, in _consolidate
    _can_consolidate=_can_consolidate)
  File "/home/Kazuki/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py", line 4876, in _merge_blocks
    new_values = new_values[argsort]
MemoryError
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "303_aggregate-2y.py", line 74, in <module>
    pool.map(aggregate, argss)
  File "/home/Kazuki/anaconda3/lib/python3.6/multiprocessing/pool.py", line 266, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/Kazuki/anaconda3/lib/python3.6/multiprocessing/pool.py", line 644, in get
    raise self._value
MemoryError
